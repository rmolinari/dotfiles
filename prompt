#
# Set up my prompt

# When we are in a git-controlled directory the prompt includes the current
# git branch and status.  In directories not in a git project there is no
# such representation.

function setprompt 
{
    export GIT_PS1_SHOWDIRTYSTATE=true
    export GIT_PS1_SHOWSTASHSTATE=true
    export GIT_PS1_SHOWUNTRACKEDFILES=true
    
    function color {
        echo "\[\e[${1};${2}m\]"
    }

    function plain {
        color 0 $1
    }
    
    function bold {
        color 1 $1
    }

    ##
    # Define local variables for each color and bold: RED, RED_BOLD, GREEN, GREEN_BOLD, etc
    #
    for pair in BLACK_30 RED_31 GREEN_32 BROWN_33 BLUE_34 PURPLE_35 CYAN_36 GRAY_37
    do
        local col=${pair%_*}
	local code=${pair#*_}
	eval "local ${col}=\$(plain ${code})"
	eval "local ${col}_BOLD=\$(bold ${code})"
    done

    local RESET_COL="\[\e[0m\]"
     	    
    PS1="${GREEN}[\u:\w]${PURPLE}\$(__git_ps1 ' [%s]')${GREEN}\n\$(date +%H:%M:%S) $ ${RESET_COL}"
    
}

setprompt
unset -f setprompt
